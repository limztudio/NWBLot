// limztudio@gmail.com
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


#pragma once


#include <logger/common.h>

#include <curl/curl.h>


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


NWB_LOG_BEGIN


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


class Server{
private:
    static bool globalInit();
    static usize receiveCallback(void* contents, usize size, usize nmemb, Server* _this);


public:
    Server();
    ~Server();


public:
    bool init(const char* url);

    bool update();


private:
    void enqueue(std::basic_string<tchar>&& str, Type type = Type::Info);
    void enqueue(const std::basic_string<tchar>& str, Type type = Type::Info);


private:
    CURL* m_curl;
    MessageQueue m_msgQueue;


private:
    static bool m_globalInit;
};


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


NWB_LOG_END


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

